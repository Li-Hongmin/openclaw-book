# ç¬¬2ç« ï¼šAgentçš„è®°å¿†ç³»ç»Ÿ

> *"Memory is the mother of all wisdom." â€” Aeschylus*

## å¼•è¨€ï¼šä¸ºä»€ä¹ˆAgentä¼š"å¥å¿˜"?

ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼š

- æ—©ä¸Šä½ å‘Šè¯‰ChatGPTï¼š"æˆ‘åœ¨åšä¸€ä¸ªå…³äºæ°”å€™å˜åŒ–çš„é¡¹ç›®"ï¼Œæ™šä¸Šå†é—®å®ƒç›¸å…³é—®é¢˜ï¼Œå®ƒå®Œå…¨ä¸è®°å¾—äº†ã€‚
- ä½ è®©AIåŠ©æ‰‹å¸®ä½ è§„åˆ’ä¸€å‘¨çš„ä»»åŠ¡ï¼Œç¬¬äºŒå¤©å®ƒå·²ç»å¿˜è®°ä½ æ˜¨å¤©è¯´äº†ä»€ä¹ˆã€‚
- ä½ åœ¨ä¸€ä¸ªå¯¹è¯ä¸­è¯¦ç»†æè¿°äº†ä½ çš„é¡¹ç›®èƒŒæ™¯,ä½†å¼€å§‹æ–°å¯¹è¯æ—¶åˆè¦é‡å¤ä¸€éã€‚

**è¿™ä¸æ˜¯AIçš„bug,è€Œæ˜¯è®¾è®¡çš„å¿…ç„¶**ã€‚ä¼ ç»Ÿçš„å¯¹è¯å¼AIå°±åƒæ‚£æœ‰"çŸ­æœŸå¤±å¿†ç—‡"çš„èªæ˜äººâ€”â€”å®ƒå¾ˆæ“…é•¿å½“ä¸‹çš„æ¨ç†,ä½†æ— æ³•å»ºç«‹é•¿æœŸè®°å¿†ã€‚

è€ŒçœŸæ­£çš„Agentç³»ç»Ÿéœ€è¦è®°å¿†ã€‚å®ƒéœ€è¦è®°ä½ï¼š
- ä½ çš„åå¥½å’Œä¹ æƒ¯
- è¿‡å»åšè¿‡çš„å†³ç­–
- è¿›è¡Œä¸­çš„ä»»åŠ¡çŠ¶æ€
- å­¦åˆ°çš„ç»éªŒå’Œæ•™è®­

**æœ¬ç« å°†è§£å†³ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜**ï¼š
1. ä¸ºä»€ä¹ˆAIå¤©ç”Ÿ"å¥å¿˜",ä»¥åŠè¿™å¦‚ä½•é™åˆ¶äº†å®ƒçš„èƒ½åŠ›ï¼Ÿ
2. Agentéœ€è¦å“ªå‡ ç§ç±»å‹çš„è®°å¿†ï¼Ÿ
3. å¦‚ä½•ç”¨æ–‡ä»¶ç³»ç»Ÿæ„å»ºAgentçš„"ç¬¬äºŒå¤§è„‘"ï¼Ÿ

è¯»å®Œæœ¬ç« ,ä½ å°†ç†è§£è®°å¿†ç³»ç»Ÿçš„è®¾è®¡åŸç†,å¹¶èƒ½æ­å»ºä¸€ä¸ªå…·æœ‰é•¿æœŸè®°å¿†èƒ½åŠ›çš„ä¸ªäººçŸ¥è¯†åº“ã€‚

---

## 2.1 ä¸ºä»€ä¹ˆAgentéœ€è¦è®°å¿†ï¼Ÿ

### çŸ­æœŸè®°å¿†çš„å±€é™

è®©æˆ‘ä»¬å…ˆç†è§£AIçš„"è®°å¿†"æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

å½“ä½ å’ŒChatGPTå¯¹è¯æ—¶,å®ƒçœ‹åˆ°çš„æ˜¯ï¼š

```
[ç³»ç»Ÿæç¤ºè¯] + [å¯¹è¯å†å²] + [ä½ çš„æœ€æ–°è¾“å…¥]
```

è¿™äº›å†…å®¹è¢«ç¼–ç æˆ**tokens**ï¼ˆå¯ä»¥ç®€å•ç†è§£ä¸ºå•è¯ç‰‡æ®µï¼‰,ç„¶åAIåŸºäºè¿™äº›tokensç”Ÿæˆå›å¤ã€‚**è¿™å°±æ˜¯AIçš„å…¨éƒ¨"è®°å¿†"**â€”â€”å½“å‰å¯¹è¯çª—å£é‡Œçš„æ‰€æœ‰å†…å®¹ã€‚

#### ä¸Šä¸‹æ–‡çª—å£ï¼šAIçš„å·¥ä½œè®°å¿†

AIæ¨¡å‹æœ‰ä¸€ä¸ª**ä¸Šä¸‹æ–‡çª—å£**ï¼ˆContext Windowï¼‰é™åˆ¶ã€‚ä»¥Claude 3.5 Sonnetä¸ºä¾‹ï¼š

- ä¸Šä¸‹æ–‡çª—å£ï¼š200K tokensï¼ˆçº¦15ä¸‡ä¸ªè‹±æ–‡å•è¯ï¼‰
- å¬èµ·æ¥å¾ˆå¤§ï¼Ÿä½†è€ƒè™‘åˆ°ï¼š
  - ä¸€æœ¬ä¸­ç­‰é•¿åº¦çš„æŠ€æœ¯ä¹¦ï¼šçº¦10ä¸‡å­—=13ä¸‡tokens
  - ä¸€ä¸ªæœˆçš„å·¥ä½œæ—¥å¿—ï¼šçº¦5-10ä¸‡tokens
  - ä½ çš„ä¸ªäººçŸ¥è¯†åº“ï¼šå¯èƒ½ä¸Šç™¾ä¸‡tokens

**ç»“æœ**ï¼šå³ä½¿æ˜¯æœ€å¤§çš„ä¸Šä¸‹æ–‡çª—å£,ä¹Ÿæ— æ³•å®¹çº³ä¸€ä¸ªäººçš„æ‰€æœ‰çŸ¥è¯†å’Œç»éªŒã€‚

#### çœŸå®æ¡ˆä¾‹ï¼šä¸Šä¸‹æ–‡çª—å£è€—å°½

æ¥çœ‹ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼š

```markdown
# æŸä¸ªAgentçš„ä¸€å¤©

08:00 - ç”Ÿæˆæ—©æŠ¥ï¼ˆæ¶ˆè€—5K tokensï¼‰
09:00 - å¤„ç†é‚®ä»¶åˆ†ç±»ï¼ˆæ¶ˆè€—10K tokensï¼‰
10:00 - ä»£ç å®¡æŸ¥ï¼ˆæ¶ˆè€—20K tokensï¼‰
14:00 - æ–‡æ¡£æ•´ç†ï¼ˆæ¶ˆè€—15K tokensï¼‰
18:00 - ç”Ÿæˆæ—¥æŠ¥ï¼ˆæ¶ˆè€—8K tokensï¼‰
...

å½“æ™š23:00,ç´¯è®¡tokens: 180K
```

**é—®é¢˜æ¥äº†**ï¼šå½“ä¸Šä¸‹æ–‡çª—å£æ¥è¿‘200Kæ—¶,Agentå¼€å§‹"é—å¿˜"æ—©ä¸Šåšçš„äº‹æƒ…ã€‚å°±åƒäººçš„å·¥ä½œè®°å¿†ï¼ˆWorking Memoryï¼‰åªèƒ½åŒæ—¶å¤„ç†7Â±2ä¸ªä¿¡æ¯å—,AIä¹Ÿæœ‰å…¶æé™ã€‚

> ğŸ’¡ **AIè¾…åŠ©æç¤º**  
> ä¸ç¡®å®štokensæ˜¯ä»€ä¹ˆï¼Ÿé—®AIï¼š  
> "ä»€ä¹ˆæ˜¯tokensï¼Ÿä¸ºä»€ä¹ˆå®ƒé™åˆ¶äº†AIçš„è®°å¿†ï¼Ÿèƒ½ç”¨ç®€å•ä¾‹å­è¯´æ˜å—ï¼Ÿ"

### é•¿æœŸè®°å¿†çš„å¿…è¦æ€§

äººç±»å¦‚ä½•å…‹æœå·¥ä½œè®°å¿†çš„é™åˆ¶ï¼Ÿç­”æ¡ˆæ˜¯**é•¿æœŸè®°å¿†**ï¼ˆLong-term Memoryï¼‰ã€‚

äººç±»å¤§è„‘çš„ç­–ç•¥ï¼š
1. **é€‰æ‹©æ€§è®°å¿†**ï¼šä¸æ˜¯æ‰€æœ‰äº‹éƒ½è®°ä½,åªè®°é‡è¦çš„
2. **å‹ç¼©å­˜å‚¨**ï¼šæŠŠè¯¦ç»†ç»å†å‹ç¼©æˆæ¦‚å¿µå’Œæ¨¡å¼
3. **å¤–éƒ¨åŒ–**ï¼šé€šè¿‡ç¬”è®°æœ¬ã€æ—¥è®°ã€æ•°æ®åº“æ‰©å±•è®°å¿†
4. **æ£€ç´¢æœºåˆ¶**ï¼šéœ€è¦æ—¶èƒ½å¿«é€Ÿè°ƒå–ç›¸å…³è®°å¿†

**Agentä¹Ÿéœ€è¦ç±»ä¼¼çš„ç³»ç»Ÿã€‚**

#### ä¸ºä»€ä¹ˆé•¿æœŸè®°å¿†è‡³å…³é‡è¦ï¼Ÿ

è€ƒè™‘è¿™äº›åœºæ™¯ï¼š

##### åœºæ™¯1ï¼šä¸ªäººåŠ©ç†Agent

```markdown
# å¦‚æœåªæœ‰çŸ­æœŸè®°å¿†ï¼š
ä½ ï¼š"æé†’æˆ‘æ˜å¤©æ—©ä¸Š9ç‚¹æ‰“ç”µè¯ç»™å¼ ä¸‰"
Agentï¼š"å¥½çš„ï¼Œå·²è®¾ç½®æé†’"

[ç¬¬äºŒå¤©ï¼ŒAgenté‡å¯]
Agentï¼šï¼ˆå®Œå…¨å¿˜è®°äº†æ˜¨å¤©çš„å¯¹è¯ï¼‰
```

```markdown
# å¦‚æœæœ‰é•¿æœŸè®°å¿†ï¼š
ä½ ï¼š"æé†’æˆ‘æ˜å¤©æ—©ä¸Š9ç‚¹æ‰“ç”µè¯ç»™å¼ ä¸‰"
Agentï¼šå†™å…¥ tasks.md â†’ "2024-01-15 09:00 - æ‰“ç”µè¯ç»™å¼ ä¸‰"

[ç¬¬äºŒå¤©ï¼ŒAgentå¯åŠ¨æ—¶è¯»å–tasks.md]
Agentï¼š"æ—©ä¸Šå¥½ï¼ä»Šå¤©9ç‚¹ä½ éœ€è¦æ‰“ç”µè¯ç»™å¼ ä¸‰ã€‚"
```

##### åœºæ™¯2ï¼šä»£ç å®¡æŸ¥Agent

```markdown
# å¦‚æœåªæœ‰çŸ­æœŸè®°å¿†ï¼š
æ¯æ¬¡å®¡æŸ¥ä»£ç éƒ½æ˜¯"ç¬¬ä¸€æ¬¡è§"
æ— æ³•å­¦ä¹ å›¢é˜Ÿçš„ä»£ç é£æ ¼
æ— æ³•è®°ä½ä¹‹å‰æè¿‡çš„é—®é¢˜
```

```markdown
# å¦‚æœæœ‰é•¿æœŸè®°å¿†ï¼š
Agentç»´æŠ¤ style-guide.md å’Œ common-issues.md
è®°å½•æ¯æ¬¡å®¡æŸ¥çš„é‡ç‚¹é—®é¢˜
ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ä¸»åŠ¨æé†’
é€æ­¥å»ºç«‹å›¢é˜ŸçŸ¥è¯†åº“
```

##### åœºæ™¯3ï¼šè‡ªæˆ‘ä¿®å¤æœåŠ¡å™¨Agent

```markdown
# å¦‚æœåªæœ‰çŸ­æœŸè®°å¿†ï¼š
æœåŠ¡å™¨ï¼šå†…å­˜ä½¿ç”¨ç‡95%
Agentï¼š"æ£€æµ‹åˆ°å†…å­˜é«˜ï¼Œé‡å¯æœåŠ¡"

[ä¸€å°æ—¶å]
æœåŠ¡å™¨ï¼šå†…å­˜ä½¿ç”¨ç‡95%
Agentï¼š"æ£€æµ‹åˆ°å†…å­˜é«˜ï¼Œé‡å¯æœåŠ¡"

ï¼ˆé™·å…¥æ— é™å¾ªç¯ï¼Œæ²¡æœ‰å­¦ä¹ ï¼‰
```

```markdown
# å¦‚æœæœ‰é•¿æœŸè®°å¿†ï¼š
æœåŠ¡å™¨ï¼šå†…å­˜ä½¿ç”¨ç‡95%
Agentï¼š
  1. å†™å…¥ incidents.logï¼š"2024-01-15 10:00 - å†…å­˜æ³„æ¼ï¼ŒæœåŠ¡A"
  2. é‡å¯æœåŠ¡
  3. æ›´æ–° known-issues.mdï¼š"æœåŠ¡Aå­˜åœ¨å†…å­˜æ³„æ¼ï¼Œå·²æissue #123"
  
[ä¸€å°æ—¶å]
æœåŠ¡å™¨ï¼šå†…å­˜ä½¿ç”¨ç‡95%
Agentï¼š
  1. è¯»å– incidents.logï¼Œå‘ç°é‡å¤é—®é¢˜
  2. "æ£€æµ‹åˆ°æœåŠ¡Aé‡å¤å†…å­˜æ³„æ¼ï¼ˆä»Šå¤©ç¬¬3æ¬¡ï¼‰"
  3. å‘é€å‘Šè­¦ï¼š"ç´§æ€¥ï¼šæœåŠ¡Aéœ€è¦äººå·¥ä»‹å…¥"
  4. è‡ªåŠ¨å›æ»šåˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬
```

**æ ¸å¿ƒæ´å¯Ÿ**ï¼šé•¿æœŸè®°å¿†è®©Agentä»"æ¯æ¬¡ä»é›¶å¼€å§‹"å˜æˆ"æŒç»­å­¦ä¹ å’Œè¿›åŒ–"ã€‚

> ğŸ“š **æ‰©å±•é˜…è¯»**  
> æƒ³æ·±å…¥äº†è§£äººç±»è®°å¿†ç³»ç»Ÿï¼Ÿæ¨èã€Šæ€è€ƒï¼Œå¿«ä¸æ…¢ã€‹ï¼ˆä¸¹å°¼å°”Â·å¡å°¼æ›¼ï¼‰ä¸­å…³äºç³»ç»Ÿ1å’Œç³»ç»Ÿ2çš„è®¨è®ºï¼Œä»¥åŠã€Šè®°å¿†çš„ä¸ƒå®—ç½ªã€‹ï¼ˆä¸¹å°¼å°”Â·å¤å…‹ç‰¹ï¼‰ã€‚

---

## 2.2 å››ç§è®°å¿†ç±»å‹

äººç±»è®°å¿†ç ”ç©¶ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¥½çš„æ¡†æ¶ã€‚åœ¨AI Agentè®¾è®¡ä¸­,æˆ‘ä»¬å¯ä»¥å€Ÿé‰´ç±»ä¼¼çš„åˆ†ç±»ï¼š

### 1. çŸ­æœŸè®°å¿†ï¼ˆShort-term Memoryï¼‰

**å®šä¹‰**ï¼šå½“å‰å¯¹è¯çª—å£ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚

**ç‰¹ç‚¹**ï¼š
- å®¹é‡æœ‰é™ï¼ˆå—ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ï¼‰
- æ˜“å¤±æ€§ï¼ˆå¯¹è¯ç»“æŸå³æ¶ˆå¤±ï¼‰
- è®¿é—®é€Ÿåº¦å¿«ï¼ˆç›´æ¥åœ¨promptä¸­ï¼‰

**å…¸å‹å†…å®¹**ï¼š
- å½“å‰å¯¹è¯çš„å®Œæ•´å†å²
- æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ç»†èŠ‚
- ä¸´æ—¶è®¡ç®—ç»“æœ

**OpenClawå®ç°**ï¼š
```markdown
æ¯æ¬¡è°ƒç”¨APIæ—¶ï¼Œä¼ å…¥çš„messagesæ•°ç»„ï¼š
[
  {role: "system", content: "ä½ æ˜¯ä¸€ä¸ªåŠ©ç†..."},
  {role: "user", content: "å¸®æˆ‘æŸ¥å¤©æ°”"},
  {role: "assistant", content: "ä½ åœ¨å“ªä¸ªåŸå¸‚ï¼Ÿ"},
  {role: "user", content: "ä¸œäº¬"},
  ...
]
```

**å±€é™**ï¼š
- æ— æ³•è·¨ä¼šè¯ä¿æŒ
- å®¹æ˜“è¢«æ–°ä¿¡æ¯"æŒ¤å‡º"
- æˆæœ¬é«˜ï¼ˆæ¯æ¬¡éƒ½ä¼ è¾“å®Œæ•´å†å²ï¼‰

### 2. å·¥ä½œè®°å¿†ï¼ˆWorking Memoryï¼‰

**å®šä¹‰**ï¼šAgentæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡æ‰€éœ€çš„ä¸Šä¸‹æ–‡ã€‚

**ç±»æ¯”**ï¼šå°±åƒä½ åœ¨åšé¡¹ç›®æ—¶ï¼Œæ¡Œä¸Šæ‘Šå¼€çš„å‡ ä»½æ–‡æ¡£ã€‚

**ç‰¹ç‚¹**ï¼š
- ä¸­ç­‰å®¹é‡ï¼ˆå‡ ä¸ªæ–‡ä»¶ã€å‡ åƒè¡Œä»£ç ï¼‰
- ä¼šè¯çº§æŒä¹…åŒ–ï¼ˆä»»åŠ¡å®Œæˆå‰ä¿æŒï¼‰
- ç»“æ„åŒ–ï¼ˆæœ‰æ˜ç¡®çš„schemaï¼‰

**å…¸å‹å†…å®¹**ï¼š
- å½“å‰ä»»åŠ¡çš„çŠ¶æ€ï¼ˆSTATE.yamlï¼‰
- ä¸´æ—¶è‰ç¨¿ï¼ˆDRAFT.mdï¼‰
- è¿›è¡Œä¸­çš„è®¡åˆ’ï¼ˆPLAN.mdï¼‰

**OpenClawå®ç°æ¡ˆä¾‹ï¼šAutonomous Project Manager**

```yaml
# STATE.yaml - é¡¹ç›®ç®¡ç†Agentçš„å·¥ä½œè®°å¿†

current_sprint:
  sprint_number: 5
  start_date: "2024-01-15"
  end_date: "2024-01-29"
  goal: "å®Œæˆç”¨æˆ·è®¤è¯æ¨¡å—"
  
active_tasks:
  - id: "task-23"
    title: "å®ç°JWT tokenåˆ·æ–°æœºåˆ¶"
    assigned_to: "dev-agent"
    status: "in_progress"
    blockers: []
    
  - id: "task-24"
    title: "ç¼–å†™APIæ–‡æ¡£"
    assigned_to: "doc-agent"
    status: "blocked"
    blockers: ["task-23"]

recent_decisions:
  - date: "2024-01-14"
    decision: "é€‰æ‹©PostgreSQLè€ŒéMongoDB"
    rationale: "éœ€è¦å¼ºä¸€è‡´æ€§å’Œäº‹åŠ¡æ”¯æŒ"
    
  - date: "2024-01-13"
    decision: "é‡‡ç”¨å¾®æœåŠ¡æ¶æ„"
    rationale: "å›¢é˜Ÿè§„æ¨¡å¢é•¿ï¼Œéœ€è¦ç‹¬ç«‹éƒ¨ç½²"
```

**ä¸ºä»€ä¹ˆéœ€è¦å·¥ä½œè®°å¿†**ï¼š
- **é¿å…é‡å¤æ¨ç†**ï¼šAgentä¸éœ€è¦æ¯æ¬¡éƒ½"é‡æ–°ç†è§£"é¡¹ç›®çŠ¶æ€
- **å¤šAgentåä½œ**ï¼šå¤šä¸ªAgentå…±äº«STATE.yamlï¼Œé¿å…ä¿¡æ¯ä¸åŒæ­¥
- **å¯å›æº¯**ï¼šé€šè¿‡Gitå†å²ï¼Œå¯ä»¥çœ‹åˆ°é¡¹ç›®çŠ¶æ€çš„æ¼”å˜

> ğŸ”§ **å®è·µæŠ€å·§**  
> å·¥ä½œè®°å¿†åº”è¯¥å¤šå¤§ï¼Ÿç»éªŒæ³•åˆ™ï¼š  
> - å•æ–‡ä»¶ä¸è¶…è¿‡1000è¡Œ  
> - æ€»å¤§å°ä¸è¶…è¿‡50KB  
> - èƒ½åœ¨1-2ç§’å†…è¢«Agentè¯»å–å’Œç†è§£

### 3. é•¿æœŸè®°å¿†ï¼ˆLong-term Memoryï¼‰

**å®šä¹‰**ï¼šAgentéœ€è¦æ°¸ä¹…ä¿å­˜çš„çŸ¥è¯†å’Œç»éªŒã€‚

**ç±»æ¯”**ï¼šä½ çš„æ—¥è®°æœ¬ã€ç¬”è®°æœ¬ã€è¿‡å»çš„é¡¹ç›®æ–‡æ¡£ã€‚

**ç‰¹ç‚¹**ï¼š
- å®¹é‡å·¨å¤§ï¼ˆç†è®ºä¸Šæ— é™ï¼‰
- æŒä¹…åŒ–ï¼ˆè·¨ä¼šè¯ã€è·¨é‡å¯ï¼‰
- éœ€è¦æ£€ç´¢æœºåˆ¶ï¼ˆæ— æ³•å…¨éƒ¨åŠ è½½ï¼‰

**å…¸å‹å†…å®¹**ï¼š
- å†å²å¯¹è¯æ—¥å¿—
- å­¦åˆ°çš„ç»éªŒæ•™è®­
- ç”¨æˆ·åå¥½å’Œä¹ æƒ¯
- ç§¯ç´¯çš„çŸ¥è¯†åº“

**OpenClawå®ç°ï¼šMemoryç³»ç»Ÿ**

```markdown
# æ–‡ä»¶ç»“æ„
workspace/
â”œâ”€â”€ memory/
â”‚   â”œâ”€â”€ 2024-01-01.md    # æ¯æ—¥æ—¥å¿—
â”‚   â”œâ”€â”€ 2024-01-02.md
â”‚   â”œâ”€â”€ ...
â”‚   â””â”€â”€ 2024-01-15.md
â”‚
â”œâ”€â”€ MEMORY.md             # é•¿æœŸè®°å¿†ï¼ˆç²¾åï¼‰
â””â”€â”€ knowledge/
    â”œâ”€â”€ tech-stack.md     # æŠ€æœ¯æ ˆçŸ¥è¯†
    â”œâ”€â”€ contacts.md       # äººè„‰å…³ç³»
    â””â”€â”€ preferences.md    # ç”¨æˆ·åå¥½
```

#### æ¯æ—¥æ—¥å¿—ï¼ˆDaily Memoryï¼‰

```markdown
# 2024-01-15.md

## å®Œæˆçš„ä»»åŠ¡
- âœ… éƒ¨ç½²äº†æ–°ç‰ˆæœ¬åˆ°ç”Ÿäº§ç¯å¢ƒ
- âœ… ä¿®å¤äº† #234 bugï¼ˆå†…å­˜æ³„æ¼ï¼‰
- âœ… ä»£ç å®¡æŸ¥ PR #456

## é‡è¦å¯¹è¯
- ç”¨æˆ·è¯´ï¼š"ä»¥åä»£ç å®¡æŸ¥å…³æ³¨æ€§èƒ½é—®é¢˜"
  â†’ æ›´æ–° code-review-guide.mdï¼Œå¢åŠ æ€§èƒ½æ£€æŸ¥æ¸…å•

## é‡åˆ°çš„é—®é¢˜
- Dockeré•œåƒæ„å»ºå¤±è´¥
  - åŸå› ï¼šbase imageç‰ˆæœ¬ä¸å…¼å®¹
  - è§£å†³ï¼špinåˆ°ç‰¹å®šç‰ˆæœ¬
  - è®°å½•åˆ° troubleshooting.md

## ä»Šæ—¥å­¦ä¹ 
- äº†è§£äº†Kubernetesçš„Readiness Probe
- é˜…è¯»äº†å…³äºRate Limitingçš„æœ€ä½³å®è·µ
```

#### é•¿æœŸè®°å¿†ï¼ˆCurated Memoryï¼‰

```markdown
# MEMORY.md

## å…³äºç”¨æˆ·

### å·¥ä½œä¹ æƒ¯
- æ—©ä¸Š8-9ç‚¹æœ€é€‚åˆæ·±åº¦å·¥ä½œ
- ä¸å–œæ¬¢è¢«æ‰“æ–­ï¼Œé‡è¦é€šçŸ¥ç”¨é‚®ä»¶
- æ¯å‘¨äº”ä¸‹åˆåšå‘¨æ€»ç»“

### æŠ€æœ¯åå¥½
- ç¼–ç¨‹è¯­è¨€ï¼šTypeScript > Python > Go
- æ•°æ®åº“ï¼šPostgreSQLï¼ˆå¼ºä¸€è‡´æ€§åœºæ™¯ï¼‰ï¼ŒRedisï¼ˆç¼“å­˜ï¼‰
- éƒ¨ç½²ï¼šKubernetes on AWS

### æ²Ÿé€šåå¥½
- ç®€æŠ¥è¦ç®€æ´ï¼Œbullet pointsä¼˜äºé•¿æ®µè½
- æŠ€æœ¯ç»†èŠ‚å¯ä»¥æ·±å…¥ï¼Œä½†å…ˆè¯´ç»“è®º
- ç´§æ€¥äº‹ä»¶ç›´æ¥å‘Telegramé€šçŸ¥

## é¡¹ç›®ä¸Šä¸‹æ–‡

### å½“å‰ä¸»è¦é¡¹ç›®ï¼šPersonalOS
- ç›®æ ‡ï¼šæ„å»ºä¸ªäººæ•ˆç‡åŸºç¡€è®¾æ–½
- æŠ€æœ¯æ ˆï¼šNext.js + tRPC + Prisma
- éƒ¨ç½²ï¼šVercel + Supabase
- è¿›åº¦ï¼šMVPé˜¶æ®µï¼Œé¢„è®¡2æœˆå®Œæˆ

### å†å²é¡¹ç›®æ•™è®­
- é¡¹ç›®Aï¼šè¿‡æ—©ä¼˜åŒ–å¯¼è‡´è¿›åº¦å»¶è¿Ÿ
  - æ•™è®­ï¼šå…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œæ€§èƒ½ä¼˜åŒ–æ”¾åœ¨v2
  
- é¡¹ç›®Bï¼šæ²¡æœ‰åšå¥½APIç‰ˆæœ¬ç®¡ç†
  - æ•™è®­ï¼šä»ä¸€å¼€å§‹å°±ç”¨ /v1/ è·¯å¾„

## é‡è¦è”ç³»äºº

### æŠ€æœ¯åŒè¡Œ
- å¼ ä¸‰ï¼šKubernetesä¸“å®¶ï¼Œé‡åˆ°K8sé—®é¢˜å¯å’¨è¯¢
- æå››ï¼šå‰ç«¯æ¶æ„å¸ˆï¼ŒUI/UXé—®é¢˜æ‰¾ä»–
- ç‹äº”ï¼šæ•°æ®åº“æ€§èƒ½ä¼˜åŒ–é«˜æ‰‹

### ä¸šåŠ¡ç›¸å…³
- é™ˆå…­ï¼šäº§å“ç»ç†ï¼Œè´Ÿè´£éœ€æ±‚æ²Ÿé€š
- èµµä¸ƒï¼šè¿è¥è´Ÿè´£äººï¼Œå…³æ³¨ç”¨æˆ·å¢é•¿æŒ‡æ ‡
```

**é•¿æœŸè®°å¿†çš„ç®¡ç†ç­–ç•¥**ï¼š
1. **æ¯æ—¥å†™å…¥**ï¼šæ¯å¤©è®°å½•é‡è¦äº‹ä»¶
2. **å®šæœŸæ•´ç†**ï¼šæ¯å‘¨/æ¯æœˆå°†æ—¥å¿—ç²¾åæç‚¼åˆ°MEMORY.md
3. **ä¸»é¢˜åˆ†ç±»**ï¼šæŒ‰é¢†åŸŸç»„ç»‡çŸ¥è¯†ï¼ˆæŠ€æœ¯ã€ä¸šåŠ¡ã€äººé™…ï¼‰
4. **å®šæœŸæ¸…ç†**ï¼šç§»é™¤è¿‡æ—¶ä¿¡æ¯ï¼Œé¿å…å™ªéŸ³

> ğŸ“š **è·¨ç« å¼•ç”¨**  
> é•¿æœŸè®°å¿†çš„æ£€ç´¢æœºåˆ¶åœ¨ç¬¬13ç« ã€ŠçŸ¥è¯†ç®¡ç†åœºæ™¯ã€‹ä¸­æ·±å…¥è®¨è®ºï¼Œç‰¹åˆ«æ˜¯RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯ã€‚

### 4. ç¨‹åºè®°å¿†ï¼ˆProcedural Memoryï¼‰

**å®šä¹‰**ï¼šå¦‚ä½•åšäº‹çš„çŸ¥è¯†â€”â€”æµç¨‹ã€æ¨¡å¼ã€æŠ€èƒ½ã€‚

**ç±»æ¯”**ï¼šå°±åƒä½ å­¦ä¼šéª‘è‡ªè¡Œè½¦åï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½"æ€è€ƒ"å¦‚ä½•ä¿æŒå¹³è¡¡ã€‚

**ç‰¹ç‚¹**ï¼š
- ç¼–ç ä¸ºå¯æ‰§è¡Œçš„è§„åˆ™å’Œè„šæœ¬
- è°ƒç”¨æˆæœ¬ä½ï¼ˆä¸å ç”¨ä¸Šä¸‹æ–‡çª—å£ï¼‰
- å¯å¤ç”¨å’Œåˆ†äº«

**å…¸å‹å†…å®¹**ï¼š
- æ ‡å‡†æ“ä½œæµç¨‹ï¼ˆSOPï¼‰
- ä»£ç æ¨¡æ¿å’Œè„šæ‰‹æ¶
- å†³ç­–æ ‘å’Œè§„åˆ™å¼•æ“
- è‡ªåŠ¨åŒ–è„šæœ¬

**OpenClawå®ç°ï¼šæŠ€èƒ½ç³»ç»Ÿï¼ˆSkillsï¼‰**

```markdown
# Skillsç›®å½•ç»“æ„
skills/
â”œâ”€â”€ github/
â”‚   â”œâ”€â”€ SKILL.md          # å¦‚ä½•ä½¿ç”¨GitHub API
â”‚   â”œâ”€â”€ create-pr.sh      # åˆ›å»ºPRçš„è„šæœ¬
â”‚   â””â”€â”€ code-review.py    # ä»£ç å®¡æŸ¥æµç¨‹
â”‚
â”œâ”€â”€ email/
â”‚   â”œâ”€â”€ SKILL.md
â”‚   â”œâ”€â”€ triage.yaml       # é‚®ä»¶åˆ†ç±»è§„åˆ™
â”‚   â””â”€â”€ templates/        # é‚®ä»¶æ¨¡æ¿
â”‚       â”œâ”€â”€ meeting-invite.md
â”‚       â””â”€â”€ status-update.md
â”‚
â””â”€â”€ server-health/
    â”œâ”€â”€ SKILL.md
    â”œâ”€â”€ check-health.sh
    â””â”€â”€ auto-heal.yaml    # è‡ªåŠ¨ä¿®å¤è§„åˆ™
```

#### æ¡ˆä¾‹ï¼šé‚®ä»¶åˆ†ç±»è§„åˆ™ï¼ˆç¨‹åºè®°å¿†ï¼‰

```yaml
# skills/email/triage.yaml

rules:
  - name: "ç´§æ€¥å®¢æˆ·é—®é¢˜"
    condition:
      from: "@customer-domain.com"
      subject_contains: ["urgent", "down", "not working"]
    action:
      label: "å®¢æˆ·æ”¯æŒ-ç´§æ€¥"
      notify: telegram
      priority: high
      
  - name: "é¡¹ç›®æ›´æ–°"
    condition:
      from: "github-notifications"
      subject_contains: ["[Project-X]"]
    action:
      label: "é¡¹ç›®X"
      archive: false
      priority: medium
      
  - name: "è¥é”€é‚®ä»¶"
    condition:
      subject_contains: ["unsubscribe", "newsletter"]
    action:
      label: "è¥é”€"
      archive: true
      priority: low
```

**ç¨‹åºè®°å¿†çš„ä»·å€¼**ï¼š
- **ä¸€è‡´æ€§**ï¼šæ¯æ¬¡éƒ½æŒ‰ç›¸åŒæ ‡å‡†æ‰§è¡Œï¼Œä¸ä¼šå› ç–²åŠ³æˆ–æƒ…ç»ªè€Œå˜åŒ–
- **å¯å®¡è®¡**ï¼šè§„åˆ™æ˜ç¡®ï¼Œå¯ä»¥reviewå’Œæ”¹è¿›
- **å¯è¿ç§»**ï¼šå¯ä»¥åˆ†äº«ç»™å…¶ä»–Agentæˆ–ç”¨æˆ·

> ğŸ’¡ **AIè¾…åŠ©æç¤º**  
> ä¸ç¡®å®šå¦‚ä½•å°†ä½ çš„æµç¨‹ç¼–ç ä¸ºè§„åˆ™ï¼Ÿé—®AIï¼š  
> "æˆ‘æœ‰ä¸€ä¸ªé‚®ä»¶åˆ†ç±»çš„æµç¨‹ï¼ˆæè¿°æµç¨‹ï¼‰ï¼Œå¦‚ä½•å°†å®ƒè½¬åŒ–ä¸ºYAMLè§„åˆ™ï¼Ÿ"

### å››ç§è®°å¿†çš„å¯¹æ¯”

| è®°å¿†ç±»å‹ | å®¹é‡ | æŒä¹…æ€§ | è®¿é—®é€Ÿåº¦ | å…¸å‹ç”¨é€” | OpenClawå®ç° |
|---------|------|--------|----------|----------|--------------|
| **çŸ­æœŸè®°å¿†** | å°ï¼ˆ200K tokensï¼‰ | ä¼šè¯çº§ | æå¿« | å½“å‰å¯¹è¯ | Messagesæ•°ç»„ |
| **å·¥ä½œè®°å¿†** | ä¸­ï¼ˆå‡ ä¸ªæ–‡ä»¶ï¼‰ | ä»»åŠ¡çº§ | å¿« | å½“å‰ä»»åŠ¡çŠ¶æ€ | STATE.yaml |
| **é•¿æœŸè®°å¿†** | å¤§ï¼ˆGBçº§ï¼‰ | æ°¸ä¹… | éœ€æ£€ç´¢ | å†å²ç»éªŒã€çŸ¥è¯†åº“ | memory/, MEMORY.md |
| **ç¨‹åºè®°å¿†** | ä¸­ï¼ˆä»£ç +é…ç½®ï¼‰ | æ°¸ä¹… | æå¿« | è‡ªåŠ¨åŒ–æµç¨‹ | Skills, è„šæœ¬ |

### è®°å¿†ç³»ç»Ÿçš„æ•´ä½“è®¾è®¡

ä¸€ä¸ªå®Œæ•´çš„Agentè®°å¿†ç³»ç»Ÿåº”è¯¥ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            çŸ­æœŸè®°å¿†ï¼ˆå¯¹è¯çª—å£ï¼‰               â”‚
â”‚  "ä½ åˆšæ‰è¯´è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ..."               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“ ï¼ˆé‡è¦ä¿¡æ¯å†™å…¥ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å·¥ä½œè®°å¿†ï¼ˆSTATE.yamlï¼‰                â”‚
â”‚  current_task: "éƒ¨ç½²v2.3.0"                  â”‚
â”‚  status: "ç­‰å¾…ç”¨æˆ·ç¡®è®¤"                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“ ï¼ˆä»»åŠ¡å®Œæˆåå½’æ¡£ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        é•¿æœŸè®°å¿†ï¼ˆmemory/YYYY-MM-DD.mdï¼‰       â”‚
â”‚  - 2024-01-15: éƒ¨ç½²v2.3.0æˆåŠŸ                â”‚
â”‚  - é‡åˆ°äº†XXé—®é¢˜ï¼Œé€šè¿‡YYè§£å†³                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“ ï¼ˆå®šæœŸæç‚¼ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é•¿æœŸè®°å¿†ï¼ˆMEMORY.md - ç²¾åï¼‰           â”‚
â”‚  éƒ¨ç½²æµç¨‹ï¼šå…ˆè·‘æµ‹è¯•ï¼Œå†ç°åº¦å‘å¸ƒï¼Œæœ€åå…¨é‡       â”‚
â”‚  å¸¸è§é—®é¢˜ï¼šæ•°æ®åº“è¿ç§»å®¹æ˜“è¶…æ—¶ï¼Œéœ€è¦åˆ†æ‰¹         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“ ï¼ˆæ²‰æ·€ä¸ºæµç¨‹ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç¨‹åºè®°å¿†ï¼ˆSkills/deploy.shï¼‰          â”‚
â”‚  #!/bin/bash                                â”‚
â”‚  npm run test && deploy-staging && ...      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®æ´å¯Ÿ**ï¼š
- **è‡ªä¸‹è€Œä¸Š**ï¼šçŸ­æœŸâ†’å·¥ä½œâ†’é•¿æœŸâ†’ç¨‹åºï¼Œè®°å¿†é€æ­¥æ²‰æ·€
- **æŒ‰éœ€åŠ è½½**ï¼šä¸æ˜¯æ‰€æœ‰è®°å¿†éƒ½åŠ è½½åˆ°ä¸Šä¸‹æ–‡ï¼ŒæŒ‰éœ€æ£€ç´¢
- **æŒç»­æ¼”åŒ–**ï¼šé€šè¿‡åé¦ˆå¾ªç¯ï¼Œè®°å¿†ç³»ç»Ÿä¸æ–­å®Œå–„

---

## 2.3 æ–‡ä»¶ä½œä¸ºè®°å¿†è½½ä½“

ç°åœ¨æˆ‘ä»¬ç†è§£äº†Agentéœ€è¦å“ªäº›è®°å¿†ï¼Œä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯ï¼š**ç”¨ä»€ä¹ˆæ¥å­˜å‚¨è¿™äº›è®°å¿†ï¼Ÿ**

ç­”æ¡ˆæ˜¯ï¼š**æ–‡ä»¶ç³»ç»Ÿ**ã€‚

### ä¸ºä»€ä¹ˆé€‰æ‹©æ–‡ä»¶ç³»ç»Ÿï¼Ÿ

ä½ å¯èƒ½ä¼šé—®ï¼š"ä¸ºä»€ä¹ˆä¸ç”¨æ•°æ®åº“ï¼Ÿæ•°æ®åº“ä¸æ˜¯æ›´é€‚åˆå­˜å‚¨æ•°æ®å—ï¼Ÿ"

è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹ï¼š

#### æ•°æ®åº“ vs æ–‡ä»¶ç³»ç»Ÿ

| ç‰¹æ€§ | æ•°æ®åº“ï¼ˆå¦‚PostgreSQLï¼‰ | æ–‡ä»¶ç³»ç»Ÿï¼ˆMarkdown/YAMLï¼‰ |
|-----|----------------------|-------------------------|
| **å¯è¯»æ€§** | SQLæŸ¥è¯¢ï¼Œå¯¹äººç±»ä¸å‹å¥½ | çº¯æ–‡æœ¬ï¼Œä»»ä½•ç¼–è¾‘å™¨éƒ½èƒ½æ‰“å¼€ |
| **ç‰ˆæœ¬æ§åˆ¶** | éœ€è¦é¢å¤–å·¥å…· | GitåŸç”Ÿæ”¯æŒ |
| **åä½œ** | éœ€è¦ç½‘ç»œè¿æ¥ | æœ¬åœ°æ–‡ä»¶ï¼Œéšå¤„å¯ç¼–è¾‘ |
| **å¤‡ä»½** | éœ€è¦ä¸“é—¨çš„å¤‡ä»½ç­–ç•¥ | Git pushå³å¤‡ä»½ |
| **è¿ç§»** | éœ€è¦å¯¼å‡º/å¯¼å…¥ | ç›´æ¥å¤åˆ¶æ–‡ä»¶å¤¹ |
| **Agentå‹å¥½** | éœ€è¦SQLæŠ€èƒ½ | ç›´æ¥read/writeæ–‡ä»¶ |
| **æ£€ç´¢é€Ÿåº¦** | å¿«ï¼ˆæœ‰ç´¢å¼•ï¼‰ | æ…¢ï¼ˆéœ€è¦å…¨æ–‡æœç´¢ï¼‰ |
| **ç»“æ„åŒ–** | å¼ºåˆ¶schema | çµæ´»ï¼ˆå¯ä»¥æ··ç”¨ï¼‰ |

**æ ¸å¿ƒç†å¿µ**ï¼šå¯¹äºAgentçš„è®°å¿†ç³»ç»Ÿï¼Œ**å¯è¯»æ€§å’Œå¯ç¼–è¾‘æ€§æ¯”æŸ¥è¯¢é€Ÿåº¦æ›´é‡è¦**ã€‚

åŸå› ï¼š
1. **äººç±»éœ€è¦ç†è§£å’Œå¹²é¢„**ï¼šè®°å¿†ä¸åªæ˜¯Agentç”¨ï¼Œäººç±»ä¹Ÿè¦èƒ½è¯»æ‡‚ã€ä¿®æ”¹
2. **Agentæ•°é‡é€šå¸¸ä¸å¤§**ï¼šä¸æ˜¯æˆåƒä¸Šä¸‡ä¸ªAgentå¹¶å‘è®¿é—®ï¼Œä¸éœ€è¦æ•°æ®åº“çº§åˆ«çš„æ€§èƒ½
3. **Gitæ˜¯å¤©ç„¶çš„æ—¶é—´æœºå™¨**ï¼šæ¯ä¸€æ¬¡æ”¹åŠ¨éƒ½å¯è¿½æº¯ã€å¯å›æ»š
4. **LLMå¤©ç„¶ç†è§£è‡ªç„¶è¯­è¨€**ï¼šMarkdownæ¯”SQLå¯¹LLMæ›´å‹å¥½

### Markdownï¼šäººç±»å’ŒAIçš„å…±åŒè¯­è¨€

**Markdownçš„ä¼˜åŠ¿**ï¼š

#### 1. è¯­ä¹‰ä¸°å¯Œ

```markdown
# é¡¹ç›®A - ç”¨æˆ·è®¤è¯æ¨¡å—

## å½“å‰çŠ¶æ€
é¡¹ç›®è¿›å…¥ç¬¬äºŒè½®æµ‹è¯•ï¼Œå‘ç°3ä¸ªP1 bugã€‚

## å¾…åŠäº‹é¡¹
- [ ] ä¿®å¤JWT tokenè¿‡æœŸé—®é¢˜ï¼ˆé¢„è®¡2hï¼‰
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡åˆ°90%
- [x] å®ŒæˆAPIæ–‡æ¡£

## å†³ç­–è®°å½•
**2024-01-15**: é€‰æ‹©bcryptè€ŒéSHA256è¿›è¡Œå¯†ç å“ˆå¸Œ
- ç†ç”±ï¼šbcryptæœ‰è‡ªé€‚åº”æˆæœ¬å› å­ï¼Œæ›´å®‰å…¨
- å‚è€ƒï¼š[OWASPå¯†ç å­˜å‚¨æŒ‡å—](...)
```

AIè¯»åˆ°è¿™æ®µMarkdownæ—¶ï¼Œå®ƒèƒ½ç†è§£ï¼š
- æ ‡é¢˜ç»“æ„ï¼ˆproject â†’ status â†’ todos â†’ decisionsï¼‰
- åˆ—è¡¨é¡¹ï¼ˆå¾…åŠäº‹é¡¹ï¼Œå·²å®Œæˆvsæœªå®Œæˆï¼‰
- å¼ºè°ƒï¼ˆåŠ ç²—çš„æ—¥æœŸï¼‰
- é“¾æ¥ï¼ˆå¤–éƒ¨å‚è€ƒï¼‰

**è¿™æ¯”çº¯JSONæˆ–æ•°æ®åº“è¡¨æ ¼å¯Œæœ‰è¡¨è¾¾åŠ›å¾—å¤šã€‚**

#### 2. å¯æ··åˆæ ¼å¼

```markdown
# æœåŠ¡å™¨å¥åº·æ£€æŸ¥æŠ¥å‘Š

## æ€»è§ˆ
- æ€»æœåŠ¡æ•°ï¼š5
- å¥åº·ï¼š4
- å¼‚å¸¸ï¼š1

## è¯¦ç»†ä¿¡æ¯

| æœåŠ¡å | çŠ¶æ€ | CPU | å†…å­˜ | æœ€åæ£€æŸ¥æ—¶é—´ |
|-------|------|-----|------|------------|
| API   | âœ…   | 45% | 2.1GB | 10:05:23 |
| DB    | âœ…   | 60% | 4.5GB | 10:05:23 |
| Redis | âŒ   | 98% | 7.8GB | 10:05:23 |

## å¼‚å¸¸è¯¦æƒ…

### RedisæœåŠ¡ï¼ˆå¼‚å¸¸ï¼‰
**ç—‡çŠ¶**ï¼šCPUä½¿ç”¨ç‡98%ï¼ŒæŒç»­10åˆ†é’Ÿ

**å¯èƒ½åŸå› **ï¼š
1. æ…¢æŸ¥è¯¢å µå¡
2. å†…å­˜ç¢ç‰‡å¯¼è‡´é¢‘ç¹GC

**å»ºè®®æªæ–½**ï¼š
\`\`\`bash
# æ£€æŸ¥æ…¢æŸ¥è¯¢
redis-cli slowlog get 10

# æŸ¥çœ‹å†…å­˜ç¢ç‰‡ç‡
redis-cli info memory | grep fragmentation
\`\`\`

**è‡ªåŠ¨ä¿®å¤è®°å½•**ï¼š
10:06:15 - æ‰§è¡Œ `redis-cli config set maxmemory-policy allkeys-lru`
10:06:30 - é‡å¯RedisæœåŠ¡
10:07:00 - CPUé™è‡³12%ï¼Œé—®é¢˜è§£å†³âœ…
```

**æ³¨æ„**ï¼šåŒä¸€ä¸ªæ–‡ä»¶æ··åˆäº†è¡¨æ ¼ã€ä»£ç å—ã€åˆ—è¡¨ã€emojiâ€”â€”è¿™ç§çµæ´»æ€§æ˜¯æ•°æ®åº“éš¾ä»¥å®ç°çš„ã€‚

> ğŸ”§ **å®è·µæŠ€å·§**  
> Markdownæ–‡ä»¶çš„å‘½åè§„èŒƒï¼š  
> - æ—¥æœŸå¼€å¤´ï¼š`2024-01-15-deploy-log.md`ï¼ˆæ˜“æ’åºï¼‰  
> - å°å†™+è¿å­—ç¬¦ï¼š`project-alpha-status.md`ï¼ˆé¿å…ç©ºæ ¼ï¼‰  
> - è¯­ä¹‰åŒ–ï¼š`user-feedback-jan-2024.md`ï¼ˆä¸€ç›®äº†ç„¶ï¼‰

### YAMLï¼šç»“æ„åŒ–é…ç½®çš„é¦–é€‰

å½“è®°å¿†éœ€è¦ä¸¥æ ¼çš„ç»“æ„æ—¶ï¼ˆå¦‚å·¥ä½œè®°å¿†STATE.yamlï¼‰ï¼ŒYAMLæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚

#### YAML vs JSON

```json
// JSON - æœºå™¨å‹å¥½ï¼Œäººç±»ä¸å‹å¥½
{
  "project": {
    "name": "OpenClaw",
    "status": "active",
    "tasks": [
      {"id": 1, "title": "Fix bug #123", "done": false},
      {"id": 2, "title": "Write docs", "done": true}
    ]
  }
}
```

```yaml
# YAML - äººç±»å’Œæœºå™¨éƒ½å‹å¥½
project:
  name: OpenClaw
  status: active
  tasks:
    - id: 1
      title: Fix bug #123
      done: false
    - id: 2
      title: Write docs
      done: true
```

**YAMLçš„ä¼˜åŠ¿**ï¼š
- æ²¡æœ‰å¤§æ‹¬å·å’Œé€—å·çš„å™ªéŸ³
- æ”¯æŒæ³¨é‡Šï¼ˆJSONä¸æ”¯æŒï¼‰
- æ›´ç®€æ´ï¼ˆç©ºæ ¼ç¼©è¿›ï¼‰

#### å®é™…æ¡ˆä¾‹ï¼šAutonomous Project Managerçš„STATE.yaml

```yaml
# STATE.yaml - è‡ªä¸»é¡¹ç›®ç®¡ç†Agentçš„å·¥ä½œè®°å¿†

meta:
  last_updated: "2024-01-15T10:30:00Z"
  agent_version: "2.1.0"
  
project:
  name: "PersonalOS"
  phase: "MVP Development"
  deadline: "2024-02-28"
  
current_sprint:
  number: 3
  start: "2024-01-08"
  end: "2024-01-22"
  goal: "Complete user authentication and basic dashboard"
  
  # å½“å‰å†²åˆºçš„ä»»åŠ¡
  tasks:
    - id: "TASK-301"
      title: "Implement JWT refresh token mechanism"
      assigned_to: "dev-agent"
      status: "in_progress"
      priority: "high"
      blockers: []
      progress: 60
      
    - id: "TASK-302"
      title: "Design dashboard UI mockups"
      assigned_to: "design-agent"
      status: "review"
      priority: "medium"
      blockers: []
      progress: 90
      
    - id: "TASK-303"
      title: "Write API documentation"
      assigned_to: "doc-agent"
      status: "blocked"
      priority: "medium"
      blockers: ["TASK-301"]  # ç­‰å¾…301å®Œæˆ
      progress: 30

# æŠ€æœ¯å†³ç­–æ—¥å¿—
decisions:
  - date: "2024-01-14"
    decision: "Use PostgreSQL for user data"
    rationale: "Need ACID guarantees for auth data"
    alternatives_considered:
      - MongoDB: "Too flexible, hard to enforce schema"
      - SQLite: "Not suitable for production scale"
    impact: "Low - standard choice for this use case"
    
  - date: "2024-01-12"
    decision: "Adopt tRPC for API layer"
    rationale: "Type-safe API calls, better DX"
    alternatives_considered:
      - REST: "Verbose, need to maintain OpenAPI spec"
      - GraphQL: "Overkill for our simple queries"
    impact: "Medium - affects frontend-backend contract"

# é£é™©è·Ÿè¸ª
risks:
  - id: "RISK-01"
    title: "Deadlineå¯èƒ½å»¶æœŸ"
    probability: "medium"
    impact: "high"
    mitigation: "æ¯å¤©ä¸‹åˆ3ç‚¹è¿›åº¦åŒæ­¥ï¼ŒåŠæ—¶è°ƒæ•´ä»»åŠ¡ä¼˜å…ˆçº§"
    status: "monitoring"
    
  - id: "RISK-02"
    title: "Third-party auth serviceä¸ç¨³å®š"
    probability: "low"
    impact: "high"
    mitigation: "å®ç°æœ¬åœ°authä½œä¸ºfallback"
    status: "mitigated"

# ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼ˆç”±Agentè‡ªåŠ¨æ›´æ–°ï¼‰
next_actions:
  - "TASK-301å®Œæˆåï¼Œç«‹å³é€šçŸ¥doc-agentå¯ä»¥å¼€å§‹TASK-303"
  - "TASK-302è¿›å…¥reviewåï¼Œå®‰æ’ä¸äº§å“ç»ç†çš„è¯„å®¡ä¼šè®®"
  - "æ¯æ—¥æ™¨ä¼šå‰æ›´æ–°æœ¬æ–‡ä»¶"
```

**ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡**ï¼š
- **ç»“æ„æ¸…æ™°**ï¼šmetaã€projectã€sprintã€decisionsã€risksåˆ†åŒºæ˜ç¡®
- **æ˜“äºè§£æ**ï¼šAgentå¯ä»¥ç›´æ¥è¯»å–ç‰¹å®šsection
- **æ˜“äºæ›´æ–°**ï¼šä¿®æ”¹å•ä¸ªä»»åŠ¡ä¸å½±å“å…¶ä»–éƒ¨åˆ†
- **æ˜“äºåä½œ**ï¼šå¤šä¸ªAgentå¯ä»¥è¯»å–åŒä¸€STATE.yamlï¼Œé¿å…ä¿¡æ¯ä¸åŒæ­¥

> ğŸ“š **è·¨ç« å¼•ç”¨**  
> STATE.yamlçš„è¯¦ç»†è®¾è®¡æ¨¡å¼åœ¨ç¬¬4ç« ã€Šæ¶æ„æ¨¡å¼ã€‹ä¸­æ·±å…¥è®¨è®ºï¼Œç‰¹åˆ«æ˜¯å¤šAgentåä½œåœºæ™¯ã€‚

### JSONï¼šä½•æ—¶ä½¿ç”¨ï¼Ÿ

è™½ç„¶YAMLæ›´æ˜“è¯»ï¼Œä½†JSONåœ¨æŸäº›åœºæ™¯ä¸‹æ›´åˆé€‚ï¼š

#### é€‚åˆç”¨JSONçš„åœºæ™¯

1. **éœ€è¦è¢«ç¨‹åºè§£æ**ï¼ˆè€Œéäººç±»é˜…è¯»ï¼‰
2. **åµŒå¥—å±‚çº§æ·±**ï¼ˆYAMLç¼©è¿›å®¹æ˜“å‡ºé”™ï¼‰
3. **ä¸å¤–éƒ¨APIäº¤äº’**ï¼ˆå¤§å¤šæ•°APIè¿”å›JSONï¼‰

#### æ¡ˆä¾‹ï¼šAPIå“åº”ç¼“å­˜

```json
// cache/weather-api-response.json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "location": {
    "city": "Tokyo",
    "coordinates": {"lat": 35.6762, "lon": 139.6503}
  },
  "current": {
    "temp": 18,
    "condition": "sunny",
    "humidity": 45
  },
  "forecast": [
    {"date": "2024-01-16", "temp_high": 20, "temp_low": 12},
    {"date": "2024-01-17", "temp_high": 19, "temp_low": 11}
  ]
}
```

**ä¸ºä»€ä¹ˆç”¨JSON**ï¼š
- ç›´æ¥ä»APIè·å–ï¼ŒåŸæ ·ä¿å­˜
- Agentå¯èƒ½éœ€è¦ä¼ ç»™å…¶ä»–APIï¼ˆJSONæ˜¯é€šç”¨æ ¼å¼ï¼‰
- åµŒå¥—ç»“æ„å¤æ‚ï¼ŒYAMLç¼©è¿›å®¹æ˜“å‡ºé”™

### Gitï¼šæ—¶é—´è½´å’Œåä½œåŸºç¡€è®¾æ–½

æ–‡ä»¶ç³»ç»Ÿçš„æœ€å¤§ä¼˜åŠ¿ä¹‹ä¸€ï¼š**GitåŸç”Ÿæ”¯æŒ**ã€‚

#### Git = Agentè®°å¿†çš„æ—¶é—´æœºå™¨

```bash
# æŸ¥çœ‹STATE.yamlçš„å†å²å˜åŒ–
git log -p STATE.yaml

# æŸæ¬¡æ”¹åŠ¨çš„è¯¦æƒ…
commit 3a7f2e9
Date: 2024-01-15 10:30:00

    Update STATE.yaml: Mark TASK-301 as in_progress
    
    - Started implementing JWT refresh mechanism
    - Estimated completion: tomorrow afternoon

diff --git a/STATE.yaml b/STATE.yaml
--- a/STATE.yaml
+++ b/STATE.yaml
@@ -15,7 +15,7 @@ current_sprint:
     - id: "TASK-301"
       title: "Implement JWT refresh token mechanism"
       assigned_to: "dev-agent"
-      status: "todo"
+      status: "in_progress"
       priority: "high"
```

**Gitç»™æˆ‘ä»¬ä»€ä¹ˆ**ï¼š
1. **å®Œæ•´å†å²**ï¼šæ¯ä¸€æ¬¡çŠ¶æ€å˜åŒ–éƒ½æœ‰è®°å½•
2. **å¯å›æ»š**ï¼šå‘ç°Agentåšé”™å†³ç­–ï¼Œç«‹å³å›åˆ°ä¹‹å‰çš„çŠ¶æ€
3. **å¤šäººåä½œ**ï¼šå¤šä¸ªAgentï¼ˆæˆ–äººç±»ï¼‰å¯ä»¥å¹¶è¡Œå·¥ä½œï¼Œé€šè¿‡Git merge
4. **è¿œç¨‹å¤‡ä»½**ï¼špushåˆ°GitHub/GitLabï¼Œæ°¸ä¸ä¸¢å¤±

#### æ¡ˆä¾‹ï¼šSelf-Healing Serverçš„å®¡è®¡æ—¥å¿—

```bash
# æœåŠ¡å™¨è‡ªåŠ¨ä¿®å¤çš„Gitå†å²
git log --oneline infra/

a3b5c7d (2024-01-15 10:30) Auto-heal: Restart Redis (CPU 98%)
f2e4d6c (2024-01-15 08:15) Auto-heal: Scale up API pods (latency > 500ms)
9b1c3e5 (2024-01-14 22:45) Auto-heal: Clean up old Docker images (disk 95%)
```

æ¯ä¸€æ¬¡è‡ªåŠ¨ä¿®å¤éƒ½æ˜¯ä¸€æ¬¡commitï¼ŒåŒ…å«ï¼š
- **What**ï¼šåšäº†ä»€ä¹ˆæ“ä½œ
- **Why**ï¼šæ£€æµ‹åˆ°ä»€ä¹ˆé—®é¢˜
- **When**ï¼šç²¾ç¡®åˆ°ç§’çš„æ—¶é—´æˆ³
- **How**ï¼šä¿®æ”¹äº†å“ªäº›é…ç½®æ–‡ä»¶ï¼ˆdiffï¼‰

**è¿™æ¯”æ•°æ®åº“æ—¥å¿—è¡¨å¼ºå¤§å¾—å¤šã€‚**

> ğŸ”§ **å®è·µæŠ€å·§**  
> Git commit messageè§„èŒƒï¼š  
> - ç¬¬ä¸€è¡Œï¼šç®€æ´æè¿°ï¼ˆ50å­—ç¬¦å†…ï¼‰  
> - ç©ºä¸€è¡Œ  
> - è¯¦ç»†è¯´æ˜ï¼šä¸ºä»€ä¹ˆè¿™æ ·æ”¹ï¼ŒèƒŒæ™¯æ˜¯ä»€ä¹ˆ  
> 
> å¥½çš„commitï¼š  
> ```
> Fix: Memory leak in Redis connection pool
> 
> Detected: Memory usage growing 100MB/hour
> Root cause: Connections not properly closed after timeout
> Solution: Added explicit conn.close() in error handler
> Result: Memory stable at 2.1GB
> ```

### æ–‡ä»¶ç»„ç»‡æœ€ä½³å®è·µ

ä¸€ä¸ªå…¸å‹çš„OpenClaw Agentå·¥ä½œåŒºï¼š

```
workspace/
â”œâ”€â”€ AGENTS.md               # Agentèº«ä»½å’Œè§’è‰²å®šä¹‰
â”œâ”€â”€ SOUL.md                 # Agentçš„"äººæ ¼"
â”œâ”€â”€ MEMORY.md               # é•¿æœŸè®°å¿†ï¼ˆç²¾åï¼‰
â”œâ”€â”€ TOOLS.md                # å¸¸ç”¨å·¥å…·å’Œå‘½ä»¤
â”‚
â”œâ”€â”€ memory/                 # æ¯æ—¥æ—¥å¿—
â”‚   â”œâ”€â”€ 2024-01-01.md
â”‚   â”œâ”€â”€ 2024-01-02.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ projects/               # è¿›è¡Œä¸­çš„é¡¹ç›®
â”‚   â”œâ”€â”€ project-alpha/
â”‚   â”‚   â”œâ”€â”€ STATE.yaml      # é¡¹ç›®çŠ¶æ€ï¼ˆå·¥ä½œè®°å¿†ï¼‰
â”‚   â”‚   â”œâ”€â”€ PLAN.md         # é¡¹ç›®è®¡åˆ’
â”‚   â”‚   â”œâ”€â”€ DECISIONS.md    # å†³ç­–æ—¥å¿—
â”‚   â”‚   â””â”€â”€ src/            # é¡¹ç›®ä»£ç 
â”‚   â”‚
â”‚   â””â”€â”€ project-beta/
â”‚       â””â”€â”€ ...
â”‚
â”œâ”€â”€ knowledge/              # çŸ¥è¯†åº“ï¼ˆé•¿æœŸè®°å¿†ï¼‰
â”‚   â”œâ”€â”€ tech/
â”‚   â”‚   â”œâ”€â”€ kubernetes.md
â”‚   â”‚   â”œâ”€â”€ postgresql.md
â”‚   â”‚   â””â”€â”€ troubleshooting.md
â”‚   â”‚
â”‚   â”œâ”€â”€ business/
â”‚   â”‚   â”œâ”€â”€ competitors.md
â”‚   â”‚   â””â”€â”€ market-research.md
â”‚   â”‚
â”‚   â””â”€â”€ people/
â”‚       â””â”€â”€ contacts.md     # äººè„‰å…³ç³»
â”‚
â”œâ”€â”€ skills/                 # ç¨‹åºè®°å¿†
â”‚   â”œâ”€â”€ github/
â”‚   â”œâ”€â”€ email/
â”‚   â””â”€â”€ server-health/
â”‚
â””â”€â”€ .git/                   # æ—¶é—´è½´å’Œå¤‡ä»½
```

**è®¾è®¡åŸåˆ™**ï¼š
1. **æ‰å¹³ä¼˜äºåµŒå¥—**ï¼šæœ€å¤š3å±‚ç›®å½•ï¼Œæ›´æ·±ä¼šå¯¼è‡´éš¾ä»¥æŸ¥æ‰¾
2. **è¯­ä¹‰åŒ–å‘½å**ï¼šæ–‡ä»¶ååº”è¯¥è‡ªè§£é‡Š
3. **åˆ†è€Œæ²»ä¹‹**ï¼šå¤§æ–‡ä»¶æ‹†åˆ†æˆå¤šä¸ªå°æ–‡ä»¶ï¼ˆæ¯ä¸ª<1000è¡Œï¼‰
4. **ç´¢å¼•æ–‡ä»¶**ï¼šæ¯ä¸ªç›®å½•æœ‰README.mdè¯´æ˜ç»“æ„

---

## 2.4 å®æˆ˜ï¼šæ­å»ºä¸ªäººçŸ¥è¯†åº“

ç°åœ¨è®©æˆ‘ä»¬åŠ¨æ‰‹æ­å»ºä¸€ä¸ªçœŸå®çš„Agentè®°å¿†ç³»ç»Ÿâ€”â€”**ä¸ªäººçŸ¥è¯†åº“ï¼ˆPersonal Knowledge Baseï¼‰**ï¼Œä½¿ç”¨RAGï¼ˆRetrieval-Augmented Generationï¼‰æŠ€æœ¯ã€‚

### ä»€ä¹ˆæ˜¯RAGï¼Ÿ

**RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰**æ˜¯ä¸€ç§è®©AI"è®°ä½"å¤§é‡çŸ¥è¯†çš„æŠ€æœ¯ã€‚

#### ä¼ ç»Ÿå¯¹è¯ vs RAG

**ä¼ ç»Ÿå¯¹è¯**ï¼š
```
ä½ ï¼š"æˆ‘ä¹‹å‰ç ”ç©¶è¿‡Kubernetesçš„ç½‘ç»œæ¨¡å‹å—ï¼Ÿ"
AIï¼š"æˆ‘ä¸çŸ¥é“ï¼Œæˆ‘æ²¡æœ‰ä½ è¿‡å»çš„è®°å¿†ã€‚"
```

**ä½¿ç”¨RAG**ï¼š
```
ä½ ï¼š"æˆ‘ä¹‹å‰ç ”ç©¶è¿‡Kubernetesçš„ç½‘ç»œæ¨¡å‹å—ï¼Ÿ"
AIï¼š
  [åœ¨åå°æ£€ç´¢ä½ çš„knowledge/tech/kubernetes.md]
  "æ˜¯çš„ï¼Œä½ åœ¨2024å¹´1æœˆç ”ç©¶è¿‡ã€‚ä½ çš„ç¬”è®°æåˆ°ï¼š
   - Kubernetesä½¿ç”¨CNIï¼ˆContainer Network Interfaceï¼‰
   - ä½ æ¯”è¾ƒäº†Calicoã€Flannelã€Cilium
   - ä½ å€¾å‘äºCiliumï¼Œå› ä¸ºå®ƒæœ‰eBPFæ€§èƒ½ä¼˜åŠ¿
   
   éœ€è¦æˆ‘è¯¦ç»†å›é¡¾ä½ çš„ç¬”è®°å—ï¼Ÿ"
```

**æ ¸å¿ƒæœºåˆ¶**ï¼š
1. **Ingestionï¼ˆæ‘„å…¥ï¼‰**ï¼šå°†ä½ çš„æ–‡æ¡£ï¼ˆMarkdownã€PDFç­‰ï¼‰åˆ‡åˆ†æˆå°å—ï¼ˆchunksï¼‰
2. **Embeddingï¼ˆåµŒå…¥ï¼‰**ï¼šå°†æ¯ä¸ªchunkè½¬åŒ–ä¸ºå‘é‡ï¼ˆä¸€ä¸²æ•°å­—ï¼‰
3. **Storageï¼ˆå­˜å‚¨ï¼‰**ï¼šå‘é‡å­˜å…¥å‘é‡æ•°æ®åº“ï¼ˆå¦‚Qdrantã€Pineconeï¼‰
4. **Retrievalï¼ˆæ£€ç´¢ï¼‰**ï¼šç”¨æˆ·æé—®æ—¶ï¼Œå°†é—®é¢˜ä¹Ÿè½¬åŒ–ä¸ºå‘é‡ï¼Œæ‰¾åˆ°æœ€ç›¸ä¼¼çš„chunks
5. **Generationï¼ˆç”Ÿæˆï¼‰**ï¼šå°†æ£€ç´¢åˆ°çš„chunkså’Œé—®é¢˜ä¸€èµ·å‘ç»™LLMï¼Œç”Ÿæˆç­”æ¡ˆ

> ğŸ’¡ **AIè¾…åŠ©æç¤º**  
> ä¸ç†è§£"å‘é‡"å’Œ"ç›¸ä¼¼åº¦"ï¼Ÿé—®AIï¼š  
> "ä»€ä¹ˆæ˜¯å‘é‡åµŒå…¥ï¼ˆvector embeddingï¼‰ï¼Ÿä¸ºä»€ä¹ˆå¯ä»¥ç”¨æ¥è¡¡é‡æ–‡æœ¬ç›¸ä¼¼åº¦ï¼Ÿèƒ½ç”¨ç®€å•ä¾‹å­è¯´æ˜å—ï¼Ÿ"

### æ­å»ºæ­¥éª¤

#### æ­¥éª¤1ï¼šå‡†å¤‡çŸ¥è¯†åº“å†…å®¹

é¦–å…ˆï¼Œåˆ›å»ºä½ çš„çŸ¥è¯†åº“æ–‡ä»¶å¤¹ï¼š

```bash
mkdir -p ~/openclaw-workspace/knowledge/tech
mkdir -p ~/openclaw-workspace/knowledge/business
mkdir -p ~/openclaw-workspace/knowledge/personal
```

æ·»åŠ ä¸€äº›æ–‡æ¡£ï¼š

```markdown
# knowledge/tech/kubernetes.md

# Kuberneteså­¦ä¹ ç¬”è®°

## 2024-01-10 - ç½‘ç»œæ¨¡å‹ç ”ç©¶

ä»Šå¤©ç ”ç©¶äº†Kubernetesçš„ç½‘ç»œæ¨¡å‹ã€‚

### CNIï¼ˆContainer Network Interfaceï¼‰
- Kubernetesä½¿ç”¨CNIä½œä¸ºç½‘ç»œæ’ä»¶æ ‡å‡†
- å¸¸è§å®ç°ï¼šCalicoã€Flannelã€Ciliumã€Weave

### CNIå¯¹æ¯”

| CNI | ä¼˜åŠ¿ | åŠ£åŠ¿ | é€‚ç”¨åœºæ™¯ |
|-----|------|------|----------|
| Calico | æ€§èƒ½å¥½ï¼ŒåŠŸèƒ½å…¨ | é…ç½®å¤æ‚ | ç”Ÿäº§ç¯å¢ƒ |
| Flannel | ç®€å•æ˜“ç”¨ | åŠŸèƒ½æœ‰é™ | æµ‹è¯•ç¯å¢ƒ |
| Cilium | eBPFé«˜æ€§èƒ½ï¼Œå¯è§‚æµ‹æ€§å¼º | éœ€è¦æ–°å†…æ ¸ | è¿½æ±‚æ€§èƒ½ |

### å†³ç­–
æˆ‘é€‰æ‹©äº†**Cilium**ï¼ŒåŸå› ï¼š
- eBPFå¸¦æ¥çš„æ€§èƒ½æå‡ï¼ˆå®˜æ–¹æ•°æ®ï¼šç½‘ç»œå»¶è¿Ÿé™ä½30%ï¼‰
- å†…ç½®ç½‘ç»œç­–ç•¥å¯è§†åŒ–ï¼ˆHubbleï¼‰
- ç¤¾åŒºæ´»è·ƒï¼ŒCNCFå­µåŒ–é¡¹ç›®

### å‚è€ƒèµ„æ–™
- [Ciliumå®˜æ–¹æ–‡æ¡£](https://cilium.io/)
- [eBPFä»‹ç»](https://ebpf.io/)
```

```markdown
# knowledge/personal/contacts.md

# é‡è¦è”ç³»äºº

## æŠ€æœ¯é¢†åŸŸ

### å¼ ä¸‰ï¼ˆKubernetesä¸“å®¶ï¼‰
- GitHub: @zhangsan
- ä¸“é•¿ï¼šK8sç”Ÿäº§ç¯å¢ƒæ’éšœ
- åˆä½œé¡¹ç›®ï¼š2023å¹´å¸®åŠ©ä¼˜åŒ–æˆ‘ä»¬çš„é›†ç¾¤æ€§èƒ½
- æœ€åè”ç³»ï¼š2024-01-05ï¼ˆè®¨è®ºCiliumè¿ç§»ï¼‰

### æå››ï¼ˆå‰ç«¯æ¶æ„å¸ˆï¼‰
- GitHub: @lisi
- ä¸“é•¿ï¼šReactã€æ€§èƒ½ä¼˜åŒ–
- åˆä½œé¡¹ç›®ï¼šPersonalOSå‰ç«¯è®¾è®¡
- æœ€åè”ç³»ï¼š2024-01-12
```

#### æ­¥éª¤2ï¼šé€‰æ‹©æŠ€æœ¯æ ˆ

æˆ‘ä»¬éœ€è¦ï¼š
1. **Embeddingæ¨¡å‹**ï¼šå°†æ–‡æœ¬è½¬åŒ–ä¸ºå‘é‡
2. **å‘é‡æ•°æ®åº“**ï¼šå­˜å‚¨å’Œæ£€ç´¢å‘é‡
3. **Agentæ¡†æ¶**ï¼šOpenClaw + RAG skill

**æ¨èæŠ€æœ¯æ ˆ**ï¼š
- Embeddingæ¨¡å‹ï¼šOpenAI `text-embedding-3-small`ï¼ˆä¾¿å®œä¸”æ•ˆæœå¥½ï¼‰
- å‘é‡æ•°æ®åº“ï¼šQdrantï¼ˆå¼€æºï¼Œå¯æœ¬åœ°éƒ¨ç½²ï¼‰
- Agentï¼šOpenClaw + è‡ªå®šä¹‰RAG skill

#### æ­¥éª¤3ï¼šå®‰è£…Qdrant

```bash
# ä½¿ç”¨Dockerè¿è¡ŒQdrant
docker run -d \
  --name qdrant \
  -p 6333:6333 \
  -v $(pwd)/qdrant_storage:/qdrant/storage \
  qdrant/qdrant
```

éªŒè¯å®‰è£…ï¼š
```bash
curl http://localhost:6333/
# åº”è¯¥è¿”å›ï¼š{"title":"qdrant - vector search engine",...}
```

#### æ­¥éª¤4ï¼šç¼–å†™Ingestionè„šæœ¬

åˆ›å»º `tools/ingest-knowledge.py`ï¼š

```python
#!/usr/bin/env python3
"""
å°†Markdownæ–‡ä»¶ingestionåˆ°Qdrantå‘é‡æ•°æ®åº“
"""

import os
from pathlib import Path
from openai import OpenAI
from qdrant_client import QdrantClient
from qdrant_client.models import Distance, VectorParams, PointStruct
import hashlib

# é…ç½®
KNOWLEDGE_BASE_PATH = Path("~/openclaw-workspace/knowledge").expanduser()
QDRANT_URL = "http://localhost:6333"
COLLECTION_NAME = "my_knowledge"
EMBEDDING_MODEL = "text-embedding-3-small"
CHUNK_SIZE = 500  # æ¯ä¸ªchunkçº¦500å­—ç¬¦

# åˆå§‹åŒ–å®¢æˆ·ç«¯
openai_client = OpenAI()
qdrant_client = QdrantClient(url=QDRANT_URL)

def create_collection():
    """åˆ›å»ºQdrant collectionï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰"""
    collections = qdrant_client.get_collections().collections
    if not any(c.name == COLLECTION_NAME for c in collections):
        qdrant_client.create_collection(
            collection_name=COLLECTION_NAME,
            vectors_config=VectorParams(
                size=1536,  # text-embedding-3-smallçš„ç»´åº¦
                distance=Distance.COSINE
            )
        )
        print(f"âœ… Created collection: {COLLECTION_NAME}")
    else:
        print(f"â„¹ï¸  Collection {COLLECTION_NAME} already exists")

def chunk_text(text: str, chunk_size: int = CHUNK_SIZE) -> list[str]:
    """å°†é•¿æ–‡æœ¬åˆ‡åˆ†æˆchunks"""
    # ç®€å•ç­–ç•¥ï¼šæŒ‰æ®µè½åˆ‡åˆ†ï¼Œç„¶ååˆå¹¶å°æ®µè½
    paragraphs = text.split('\n\n')
    chunks = []
    current_chunk = ""
    
    for para in paragraphs:
        if len(current_chunk) + len(para) < chunk_size:
            current_chunk += para + "\n\n"
        else:
            if current_chunk:
                chunks.append(current_chunk.strip())
            current_chunk = para + "\n\n"
    
    if current_chunk:
        chunks.append(current_chunk.strip())
    
    return chunks

def get_embedding(text: str) -> list[float]:
    """è·å–æ–‡æœ¬çš„embeddingå‘é‡"""
    response = openai_client.embeddings.create(
        model=EMBEDDING_MODEL,
        input=text
    )
    return response.data[0].embedding

def ingest_file(file_path: Path):
    """å¤„ç†å•ä¸ªMarkdownæ–‡ä»¶"""
    print(f"Processing: {file_path}")
    
    # è¯»å–æ–‡ä»¶
    content = file_path.read_text(encoding='utf-8')
    
    # åˆ‡åˆ†æˆchunks
    chunks = chunk_text(content)
    print(f"  Split into {len(chunks)} chunks")
    
    # ä¸ºæ¯ä¸ªchunkç”Ÿæˆembeddingå¹¶å­˜å‚¨
    points = []
    for i, chunk in enumerate(chunks):
        # ç”Ÿæˆå”¯ä¸€IDï¼ˆåŸºäºæ–‡ä»¶è·¯å¾„+chunkç´¢å¼•ï¼‰
        chunk_id = hashlib.md5(
            f"{file_path}:{i}".encode()
        ).hexdigest()
        
        # è·å–embedding
        embedding = get_embedding(chunk)
        
        # åˆ›å»ºpoint
        point = PointStruct(
            id=chunk_id,
            vector=embedding,
            payload={
                "text": chunk,
                "source_file": str(file_path),
                "chunk_index": i,
                "total_chunks": len(chunks)
            }
        )
        points.append(point)
    
    # æ‰¹é‡ä¸Šä¼ åˆ°Qdrant
    qdrant_client.upsert(
        collection_name=COLLECTION_NAME,
        points=points
    )
    print(f"  âœ… Uploaded {len(points)} chunks")

def ingest_all():
    """å¤„ç†æ‰€æœ‰Markdownæ–‡ä»¶"""
    create_collection()
    
    # é€’å½’æŸ¥æ‰¾æ‰€æœ‰.mdæ–‡ä»¶
    md_files = list(KNOWLEDGE_BASE_PATH.rglob("*.md"))
    print(f"\nFound {len(md_files)} Markdown files")
    
    for file_path in md_files:
        try:
            ingest_file(file_path)
        except Exception as e:
            print(f"  âŒ Error processing {file_path}: {e}")
    
    print("\nğŸ‰ Ingestion complete!")

if __name__ == "__main__":
    ingest_all()
```

è¿è¡Œingestionï¼š
```bash
python tools/ingest-knowledge.py
```

è¾“å‡ºï¼š
```
Found 15 Markdown files

Processing: knowledge/tech/kubernetes.md
  Split into 8 chunks
  âœ… Uploaded 8 chunks
  
Processing: knowledge/personal/contacts.md
  Split into 3 chunks
  âœ… Uploaded 3 chunks

...

ğŸ‰ Ingestion complete!
```

#### æ­¥éª¤5ï¼šç¼–å†™æ£€ç´¢å‡½æ•°

åˆ›å»º `tools/search-knowledge.py`ï¼š

```python
#!/usr/bin/env python3
"""
æœç´¢çŸ¥è¯†åº“
"""

import sys
from openai import OpenAI
from qdrant_client import QdrantClient

QDRANT_URL = "http://localhost:6333"
COLLECTION_NAME = "my_knowledge"
EMBEDDING_MODEL = "text-embedding-3-small"
TOP_K = 5  # è¿”å›æœ€ç›¸ä¼¼çš„5ä¸ªchunks

openai_client = OpenAI()
qdrant_client = QdrantClient(url=QDRANT_URL)

def search(query: str, top_k: int = TOP_K):
    """æœç´¢çŸ¥è¯†åº“"""
    # 1. å°†æŸ¥è¯¢è½¬åŒ–ä¸ºå‘é‡
    query_embedding = openai_client.embeddings.create(
        model=EMBEDDING_MODEL,
        input=query
    ).data[0].embedding
    
    # 2. åœ¨Qdrantä¸­æœç´¢
    search_results = qdrant_client.search(
        collection_name=COLLECTION_NAME,
        query_vector=query_embedding,
        limit=top_k
    )
    
    # 3. æ ¼å¼åŒ–ç»“æœ
    print(f"\nğŸ” Search results for: \"{query}\"\n")
    print("=" * 60)
    
    for i, result in enumerate(search_results, 1):
        print(f"\n[Result {i}] (score: {result.score:.3f})")
        print(f"Source: {result.payload['source_file']}")
        print(f"Chunk {result.payload['chunk_index'] + 1}/{result.payload['total_chunks']}")
        print("-" * 60)
        print(result.payload['text'][:300] + "...")
        print()

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: python search-knowledge.py <query>")
        sys.exit(1)
    
    query = " ".join(sys.argv[1:])
    search(query)
```

æµ‹è¯•æœç´¢ï¼š
```bash
python tools/search-knowledge.py "æˆ‘ä¹‹å‰ç ”ç©¶è¿‡å“ªäº›Kubernetesç½‘ç»œæ–¹æ¡ˆï¼Ÿ"
```

è¾“å‡ºï¼š
```
ğŸ” Search results for: "æˆ‘ä¹‹å‰ç ”ç©¶è¿‡å“ªäº›Kubernetesç½‘ç»œæ–¹æ¡ˆï¼Ÿ"

============================================================

[Result 1] (score: 0.876)
Source: knowledge/tech/kubernetes.md
Chunk 3/8
------------------------------------------------------------
### CNIå¯¹æ¯”

| CNI | ä¼˜åŠ¿ | åŠ£åŠ¿ | é€‚ç”¨åœºæ™¯ |
|-----|------|------|----------|
| Calico | æ€§èƒ½å¥½ï¼ŒåŠŸèƒ½å…¨ | é…ç½®å¤æ‚ | ç”Ÿäº§ç¯å¢ƒ |
| Flannel | ç®€å•æ˜“ç”¨ | åŠŸèƒ½æœ‰é™ | æµ‹è¯•ç¯å¢ƒ |
| Cilium | eBPFé«˜æ€§èƒ½ï¼Œå¯è§‚æµ‹æ€§å¼º | éœ€è¦æ–°å†…æ ¸ | è¿½æ±‚æ€§èƒ½ |

### å†³ç­–
æˆ‘é€‰æ‹©äº†**Cilium**...

[Result 2] (score: 0.834)
Source: knowledge/tech/kubernetes.md
Chunk 2/8
------------------------------------------------------------
### CNIï¼ˆContainer Network Interfaceï¼‰
- Kubernetesä½¿ç”¨CNIä½œä¸ºç½‘ç»œæ’ä»¶æ ‡å‡†
- å¸¸è§å®ç°ï¼šCalicoã€Flannelã€Ciliumã€Weave...
```

**å®Œç¾ï¼** æˆ‘ä»¬æˆåŠŸæ£€ç´¢åˆ°äº†ç›¸å…³çŸ¥è¯†ã€‚

#### æ­¥éª¤6ï¼šé›†æˆåˆ°OpenClaw Agent

æœ€åï¼Œåˆ›å»ºä¸€ä¸ªOpenClaw skillæ¥ä½¿ç”¨è¿™ä¸ªRAGç³»ç»Ÿã€‚

åˆ›å»º `skills/knowledge-base/SKILL.md`ï¼š

```markdown
# Knowledge Base RAG Skill

## æè¿°
æœç´¢ä¸ªäººçŸ¥è¯†åº“ï¼Œæ£€ç´¢ç›¸å…³ç¬”è®°å’Œæ–‡æ¡£ã€‚

## ä½¿ç”¨æ–¹å¼

### æœç´¢çŸ¥è¯†åº“
\`\`\`bash
python ~/openclaw-workspace/tools/search-knowledge.py "<query>"
\`\`\`

### æ›´æ–°çŸ¥è¯†åº“ï¼ˆé‡æ–°ingestionï¼‰
\`\`\`bash
python ~/openclaw-workspace/tools/ingest-knowledge.py
\`\`\`

## ä½•æ—¶ä½¿ç”¨

- ç”¨æˆ·é—®"æˆ‘ä¹‹å‰ç ”ç©¶è¿‡XXå—ï¼Ÿ"
- ç”¨æˆ·é—®"æˆ‘å¯¹XXçš„çœ‹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ"
- éœ€è¦å›é¡¾è¿‡å»çš„ç¬”è®°å’Œå†³ç­–
- æŸ¥æ‰¾æŸä¸ªäººçš„è”ç³»æ–¹å¼æˆ–èƒŒæ™¯

## ç¤ºä¾‹

**ç”¨æˆ·**ï¼š"æˆ‘ä¹‹å‰ç ”ç©¶è¿‡Kubernetesç½‘ç»œæ–¹æ¡ˆå—ï¼Ÿ"

**Agentè¡ŒåŠ¨**ï¼š
1. è¿è¡Œï¼š`python tools/search-knowledge.py "Kubernetesç½‘ç»œæ–¹æ¡ˆ"`
2. è·å–top 3ç›¸å…³chunks
3. æ€»ç»“ç»™ç”¨æˆ·ï¼š"æ˜¯çš„ï¼Œä½ ç ”ç©¶è¿‡Calicoã€Flannelå’ŒCiliumä¸‰ç§æ–¹æ¡ˆï¼Œæœ€ç»ˆé€‰æ‹©äº†Cilium..."
```

æ›´æ–° `AGENTS.md`ï¼Œè®©AgentçŸ¥é“å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæŠ€èƒ½ï¼š

```markdown
## è®°å¿†ç³»ç»Ÿ

ä½ æœ‰ä¸€ä¸ªé•¿æœŸè®°å¿†ç³»ç»Ÿï¼ˆPersonal Knowledge Baseï¼‰ã€‚

### ä½•æ—¶ä½¿ç”¨
- ç”¨æˆ·é—®èµ·è¿‡å»çš„äº‹æƒ…ã€ç ”ç©¶ã€å†³ç­–
- éœ€è¦æŸ¥æ‰¾æŸä¸ªæŠ€æœ¯ç»†èŠ‚
- ç”¨æˆ·æåˆ°"æˆ‘ä¹‹å‰è¯´è¿‡..."

### å¦‚ä½•ä½¿ç”¨
\`\`\`bash
# æœç´¢çŸ¥è¯†åº“
python ~/openclaw-workspace/tools/search-knowledge.py "<query>"

# å°†ç»“æœæ€»ç»“åå›å¤ç”¨æˆ·
\`\`\`

### è‡ªåŠ¨æ›´æ–°
- æ¯æ¬¡ç”¨æˆ·åˆ†äº«é‡è¦ä¿¡æ¯ï¼Œä½ åº”è¯¥ï¼š
  1. å°†ä¿¡æ¯æ·»åŠ åˆ°ç›¸åº”çš„knowledge/æ–‡ä»¶
  2. è¿è¡Œ ingest-knowledge.py æ›´æ–°å‘é‡æ•°æ®åº“
```

#### æ­¥éª¤7ï¼šæµ‹è¯•å®Œæ•´æµç¨‹

ç°åœ¨å’ŒAgentå¯¹è¯ï¼š

```
ä½ ï¼š"æˆ‘ä¹‹å‰ç ”ç©¶è¿‡Kubernetesçš„ç½‘ç»œæ¨¡å‹å—ï¼Ÿ"

Agentï¼š[å†…éƒ¨æ€è€ƒ]
  1. è¿™æ˜¯å…³äºè¿‡å»è®°å¿†çš„é—®é¢˜
  2. åº”è¯¥æœç´¢knowledge base
  3. è¿è¡Œ: python tools/search-knowledge.py "Kubernetesç½‘ç»œæ¨¡å‹"
  4. è·å–ç»“æœ...

Agentå›å¤ï¼š"æ˜¯çš„ï¼Œä½ åœ¨2024å¹´1æœˆ10æ—¥ç ”ç©¶è¿‡Kubernetesçš„ç½‘ç»œæ¨¡å‹ã€‚
ä½ æ¯”è¾ƒäº†ä¸‰ç§CNIæ–¹æ¡ˆï¼š

1. **Calico** - æ€§èƒ½å¥½ï¼ŒåŠŸèƒ½å…¨ï¼Œä½†é…ç½®å¤æ‚
2. **Flannel** - ç®€å•æ˜“ç”¨ï¼Œä½†åŠŸèƒ½æœ‰é™
3. **Cilium** - eBPFé«˜æ€§èƒ½ï¼Œå¯è§‚æµ‹æ€§å¼º

ä½ æœ€ç»ˆé€‰æ‹©äº†**Cilium**ï¼Œä¸»è¦åŸå› æ˜¯ï¼š
- eBPFå¸¦æ¥çš„æ€§èƒ½æå‡ï¼ˆç½‘ç»œå»¶è¿Ÿé™ä½30%ï¼‰
- å†…ç½®ç½‘ç»œç­–ç•¥å¯è§†åŒ–ï¼ˆHubbleï¼‰
- ç¤¾åŒºæ´»è·ƒ

éœ€è¦æˆ‘è¯¦ç»†å›é¡¾ä½ çš„ç¬”è®°å—ï¼Ÿ"
```

**æˆåŠŸï¼** Agentç°åœ¨æœ‰äº†é•¿æœŸè®°å¿†ã€‚

### RAGç³»ç»Ÿçš„ä¼˜åŒ–

#### ä¼˜åŒ–1ï¼šæ··åˆæ£€ç´¢ï¼ˆHybrid Searchï¼‰

å•çº¯çš„è¯­ä¹‰æœç´¢æœ‰æ—¶ä¼šæ¼æ‰ç²¾ç¡®åŒ¹é…ã€‚ç»“åˆå…³é”®è¯æœç´¢æ›´å¥½ï¼š

```python
def hybrid_search(query: str, top_k: int = TOP_K):
    """æ··åˆæ£€ç´¢ï¼šè¯­ä¹‰ + å…³é”®è¯"""
    # 1. è¯­ä¹‰æœç´¢
    semantic_results = qdrant_client.search(
        collection_name=COLLECTION_NAME,
        query_vector=get_embedding(query),
        limit=top_k * 2  # å¤šå–ä¸€äº›å€™é€‰
    )
    
    # 2. å…³é”®è¯æœç´¢ï¼ˆç®€å•ç‰ˆï¼šæ£€æŸ¥queryä¸­çš„å…³é”®è¯æ˜¯å¦å‡ºç°åœ¨textä¸­ï¼‰
    keywords = set(query.lower().split())
    
    # 3. é‡æ–°æ’åºï¼šè¯­ä¹‰ç›¸ä¼¼åº¦ + å…³é”®è¯åŒ¹é…æ•°
    scored_results = []
    for result in semantic_results:
        text_lower = result.payload['text'].lower()
        keyword_matches = sum(1 for kw in keywords if kw in text_lower)
        # ç»¼åˆåˆ†æ•° = è¯­ä¹‰åˆ†æ•° * 0.7 + å…³é”®è¯åŒ¹é… * 0.3
        combined_score = result.score * 0.7 + (keyword_matches / len(keywords)) * 0.3
        scored_results.append((combined_score, result))
    
    # æŒ‰ç»¼åˆåˆ†æ•°æ’åº
    scored_results.sort(reverse=True, key=lambda x: x[0])
    return [r for _, r in scored_results[:top_k]]
```

#### ä¼˜åŒ–2ï¼šè‡ªåŠ¨æ›´æ–°æœºåˆ¶

è®©Agentè‡ªåŠ¨æ£€æµ‹knowledge/ç›®å½•çš„å˜åŒ–å¹¶é‡æ–°ingestionï¼š

```python
# tools/watch-and-ingest.py
import time
from watchdog.observers import Observer
from watchdog.events import FileSystemEventHandler

class KnowledgeBaseHandler(FileSystemEventHandler):
    def on_modified(self, event):
        if event.src_path.endswith('.md'):
            print(f"Detected change: {event.src_path}")
            print("Re-ingesting...")
            ingest_file(Path(event.src_path))

if __name__ == "__main__":
    observer = Observer()
    observer.schedule(KnowledgeBaseHandler(), KNOWLEDGE_BASE_PATH, recursive=True)
    observer.start()
    print("ğŸ‘€ Watching for changes in knowledge base...")
    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        observer.stop()
    observer.join()
```

åœ¨åå°è¿è¡Œï¼š
```bash
python tools/watch-and-ingest.py &
```

ç°åœ¨ï¼Œæ¯æ¬¡ä½ æ›´æ–°knowledge/ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œéƒ½ä¼šè‡ªåŠ¨é‡æ–°ingestionï¼

> ğŸ”§ **å®è·µæŠ€å·§**  
> RAGç³»ç»Ÿçš„æ•ˆæœé«˜åº¦ä¾èµ–chunkå¤§å°ï¼š  
> - **å¤ªå°**ï¼ˆ<200å­—ç¬¦ï¼‰ï¼šç¼ºä¹ä¸Šä¸‹æ–‡ï¼Œæ£€ç´¢ç»“æœä¸å®Œæ•´  
> - **å¤ªå¤§**ï¼ˆ>1000å­—ç¬¦ï¼‰ï¼šå™ªéŸ³å¤šï¼Œç›¸ä¼¼åº¦è®¡ç®—ä¸å‡†ç¡®  
> - **æ¨è**ï¼š500-800å­—ç¬¦ï¼Œä»¥æ®µè½ä¸ºå•ä½åˆ‡åˆ†

#### ä¼˜åŒ–3ï¼šå…ƒæ•°æ®è¿‡æ»¤

æœ‰æ—¶ä½ æƒ³é™å®šæœç´¢èŒƒå›´ï¼š

```python
def search_with_filter(query: str, source_filter: str = None):
    """æ”¯æŒè¿‡æ»¤çš„æœç´¢"""
    query_filter = None
    if source_filter:
        from qdrant_client.models import Filter, FieldCondition, MatchValue
        query_filter = Filter(
            must=[
                FieldCondition(
                    key="source_file",
                    match=MatchValue(value=source_filter)
                )
            ]
        )
    
    results = qdrant_client.search(
        collection_name=COLLECTION_NAME,
        query_vector=get_embedding(query),
        query_filter=query_filter,
        limit=TOP_K
    )
    return results
```

ä½¿ç”¨ï¼š
```bash
# åªæœç´¢æŠ€æœ¯ç±»ç¬”è®°
python search-knowledge.py "Kubernetes" --filter "knowledge/tech/"
```

### æ€»ç»“ï¼šRAGç³»ç»Ÿçš„ä»·å€¼

é€šè¿‡æ­å»ºRAGç³»ç»Ÿï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

1. **æ— é™è®°å¿†**ï¼šä¸å—ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ï¼Œå¯ä»¥å­˜å‚¨GBçº§åˆ«çš„çŸ¥è¯†
2. **ç²¾å‡†æ£€ç´¢**ï¼šé€šè¿‡è¯­ä¹‰æœç´¢ï¼Œæ‰¾åˆ°çœŸæ­£ç›¸å…³çš„å†…å®¹
3. **æŒç»­å­¦ä¹ **ï¼šæ¯æ¬¡æ·»åŠ æ–°ç¬”è®°ï¼ŒAgentçš„"å¤§è„‘"å°±æ›´ä¸°å¯Œ
4. **å¯è§£é‡Šæ€§**ï¼šæ£€ç´¢ç»“æœæ˜ç¡®æ˜¾ç¤ºæ¥æºï¼Œå¯è¿½æº¯

**è¿™å°±æ˜¯Agentè®°å¿†ç³»ç»Ÿçš„æ ¸å¿ƒ**â€”â€”ä»"å¥å¿˜çš„åŠ©æ‰‹"åˆ°"æ‹¥æœ‰é•¿æœŸè®°å¿†çš„æ™ºèƒ½ä½“"ã€‚

---

## æœ¬ç« æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **AIå¤©ç”Ÿ"å¥å¿˜"**ï¼šä¸Šä¸‹æ–‡çª—å£æœ‰é™ï¼Œæ— æ³•è®°ä½æ‰€æœ‰ä¿¡æ¯
2. **å››ç§è®°å¿†ç±»å‹**ï¼š
   - **çŸ­æœŸè®°å¿†**ï¼šå¯¹è¯çª—å£ï¼Œæ˜“å¤±
   - **å·¥ä½œè®°å¿†**ï¼šSTATE.yamlï¼Œä»»åŠ¡çº§æŒä¹…åŒ–
   - **é•¿æœŸè®°å¿†**ï¼šmemory/æ–‡ä»¶ï¼Œæ°¸ä¹…å­˜å‚¨
   - **ç¨‹åºè®°å¿†**ï¼šSkillsï¼Œå¯æ‰§è¡Œçš„æµç¨‹
3. **æ–‡ä»¶ä¼˜äºæ•°æ®åº“**ï¼šå¯¹äºAgentè®°å¿†ï¼Œå¯è¯»æ€§å’ŒGitæ”¯æŒæ¯”æŸ¥è¯¢é€Ÿåº¦æ›´é‡è¦
4. **Markdown/YAML/JSON**ï¼šæ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æ ¼å¼
5. **Git = æ—¶é—´æœºå™¨**ï¼šæ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½å¯è¿½æº¯ã€å¯å›æ»š
6. **RAGç³»ç»Ÿ**ï¼šé€šè¿‡å‘é‡æ£€ç´¢å®ç°"æ— é™è®°å¿†"

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

- [ ] åˆ›å»ºä½ çš„`knowledge/`ç›®å½•ï¼Œå¼€å§‹è®°å½•ç¬”è®°
- [ ] æ­å»ºQdrantå‘é‡æ•°æ®åº“
- [ ] è¿è¡Œingestionè„šæœ¬ï¼Œæ„å»ºä½ çš„ç¬¬ä¸€ä¸ªRAGç³»ç»Ÿ
- [ ] æ›´æ–°`AGENTS.md`ï¼Œè®©AgentçŸ¥é“å¦‚ä½•ä½¿ç”¨è®°å¿†ç³»ç»Ÿ
- [ ] å°è¯•é—®Agentï¼š"æˆ‘ä¹‹å‰ç ”ç©¶è¿‡XXå—ï¼Ÿ"

### å»¶ä¼¸é˜…è¯»

- ğŸ“š **è®°å¿†å¿ƒç†å­¦**ï¼šã€Šè®°å¿†çš„ä¸ƒå®—ç½ªã€‹ï¼ˆä¸¹å°¼å°”Â·å¤å…‹ç‰¹ï¼‰
- ğŸ”§ **RAGæŠ€æœ¯**ï¼šLangChainå®˜æ–¹æ–‡æ¡£çš„RAGæ•™ç¨‹
- ğŸ¯ **å‘é‡æ•°æ®åº“å¯¹æ¯”**ï¼šQdrant vs Pinecone vs Weaviate
- ğŸ—ï¸ **Obsidian + RAG**ï¼šå°†ç¬”è®°åº”ç”¨ä¸Agentç»“åˆ

### è·¨ç« å¼•ç”¨é¢„å‘Š

- **ç¬¬4ç« ã€Šæ¶æ„æ¨¡å¼ã€‹**ï¼šå¤šAgentå¦‚ä½•å…±äº«è®°å¿†ï¼ŸSTATE.yamlçš„åä½œæ¨¡å¼
- **ç¬¬11ç« ã€ŠåŸºç¡€è®¾æ–½åœºæ™¯ã€‹**ï¼šå¦‚ä½•ç”¨è®°å¿†ç³»ç»Ÿç®¡ç†Home LabçŸ¥è¯†åº“
- **ç¬¬13ç« ã€ŠçŸ¥è¯†ç®¡ç†åœºæ™¯ã€‹**ï¼šæ›´é«˜çº§çš„RAGæŠ€æœ¯ï¼ŒåŒ…æ‹¬æ··åˆæ£€ç´¢å’Œre-ranking

---

> ğŸ’¬ **æ€è€ƒé¢˜**  
> 1. ä½ ç°åœ¨ç”¨ä»€ä¹ˆå·¥å…·ç®¡ç†ä¸ªäººçŸ¥è¯†ï¼Ÿï¼ˆNotionã€Obsidianã€ç¬”è®°æœ¬ï¼Ÿï¼‰  
> 2. å¦‚æœè®©Agentç®¡ç†ä½ çš„çŸ¥è¯†åº“ï¼Œä½ å¸Œæœ›å®ƒèƒ½åšä»€ä¹ˆï¼Ÿ  
> 3. ä½ æœ‰å“ªäº›é‡å¤æ€§çš„"è®°å¿†æ£€ç´¢"ä»»åŠ¡å¯ä»¥äº¤ç»™Agentï¼Ÿ

ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†æ¢è®¨**Agentæ€ç»´æ¨¡å¼**â€”â€”å¦‚ä½•ä»ä¼ ç»Ÿè„šæœ¬æ€ç»´è½¬å˜ä¸ºæ™ºèƒ½ä½“æ€ç»´ï¼Œç†è§£Agentå†³ç­–çš„å†…åœ¨æœºåˆ¶ã€‚
